<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration Confirmation | Justice Half Marathon 2025</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Verify your Justice Half Marathon 2025 registration. Search by mobile number or transaction ID to confirm your registration details.">
    <meta name="keywords" content="Justice Half Marathon confirmation, Bangladesh marathon registration verification, Sylhet running event confirmation">
    <meta name="author" content="Army IBA Hiking & Trekking Club, Sylhet">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph (Facebook/Social Media) -->
    <meta property="og:title" content="Registration Confirmation | Justice Half Marathon 2025">
    <meta property="og:description" content="Verify your Justice Half Marathon 2025 registration. Search by mobile number or transaction ID.">
    <meta property="og:image" content="https://justicehalfmarathon.com/photos/marathon.png">
    <meta property="og:url" content="https://justicehalfmarathon.com/confirmation.html">
    <meta property="og:type" content="website">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Registration Confirmation | Justice Half Marathon 2025">
    <meta name="twitter:description" content="Verify your Justice Half Marathon 2025 registration details.">
    <meta name="twitter:image" content="https://justicehalfmarathon.com/photos/marathon.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://justicehalfmarathon.com/confirmation.html">
    <link rel="icon" type="image/png" href="photos/aiba.jpg">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        main: '#005840',
                    },
                },
            },
        }
    </script>
    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NK9Z5DRC');</script>
    <!-- End Google Tag Manager -->

    <!-- Hotjar Tracking Code -->
    <script>
        (function(h,o,t,j,a,r){
            h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
            h._hjSettings={hjid:6463281,hjsv:6};
            a=o.getElementsByTagName('head')[0];
            r=o.createElement('script');r.async=1;
            r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
            a.appendChild(r);
        })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
    </script>
    
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f0f4f8; /* Matching the other pages */
            color: #2d3748;
            min-height: 100vh;
        }
        
        /* Enhanced Animations */
        .fade-in { animation: fadeIn 0.6s ease-out; }
        .scale-in { animation: scaleIn 0.4s ease-out; }
        .slide-up { animation: slideUp 0.5s ease-out; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.95); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Modern Card Design */
        .modern-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border-radius: 16px;
            transition: all 0.3s ease;
        }
        
        .modern-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        
        /* Enhanced Loading Spinner */
        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid #ffffff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Modern Input Styling */
        .modern-input {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(0, 88, 64, 0.1);
            border-radius: 12px;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        .modern-input:focus {
            border-color: #005840;
            box-shadow: 0 0 0 4px rgba(0, 88, 64, 0.1);
            background: rgba(255, 255, 255, 1);
        }
        
        /* Modern Button */
        .modern-btn {
            background: linear-gradient(135deg, #005840 0%, #007A5A 100%);
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 88, 64, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .modern-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 88, 64, 0.4);
        }
        
        .modern-btn:active {
            transform: translateY(0);
        }
        
        .modern-btn:disabled {
            opacity: 0.7;
            transform: none;
            cursor: not-allowed;
        }
        
        /* Status Badge Styles */
        .status-confirmed {
            background: linear-gradient(135deg, #10B981 0%, #059669 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .status-pending {
            background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Data Grid Enhancement */
        .data-item {
            background: rgba(248, 250, 252, 0.8);
            border: 1px solid rgba(226, 232, 240, 0.5);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .data-item:hover {
            background: rgba(255, 255, 255, 0.9);
            border-color: rgba(0, 88, 64, 0.2);
            transform: translateY(-1px);
        }
        
        /* Professional Typography */
        .section-title {
            background: linear-gradient(135deg, #1F2937 0%, #374151 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            letter-spacing: -0.025em;
        }
        
        /* Alert Boxes */
        .alert-success {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.1) 100%);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 12px;
        }
        
        .alert-warning {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(217, 119, 6, 0.1) 100%);
            border: 1px solid rgba(245, 158, 11, 0.2);
            border-radius: 12px;
        }
        
        .alert-error {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(220, 38, 38, 0.1) 100%);
            border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: 12px;
        }
        
        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .modern-card {
                margin: 0 16px;
                border-radius: 12px;
            }
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen">
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/gtm.ns.html?id=GTM-NK9Z5DRC"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <!-- Navigation -->
    <header class="bg-white shadow-2xl py-4 z-50 rounded-b-3xl transition-all duration-300 border-b-4 border-[#005840]/60">
        <div class="container mx-auto px-3 sm:px-6">
            <!-- Desktop: All logos, name, and menu in a single row for xl and up -->
            <div class="hidden xl:flex flex-row items-center justify-between w-full gap-8 fixed top-0 left-0 right-0 z-50 bg-white border-b-4 border-[#005840]/60 shadow-2xl rounded-b-3xl transition-all duration-300">
                <div class="flex flex-row items-center gap-6">
                    <img src="photos/logo3.png" alt="Event Logo" class="h-20 w-auto object-contain shadow-2xl">
                    <img src="photos/aiba.jpg" alt="AIBA Logo" class="h-14 w-14 rounded-full object-cover">
                    <img src="photos/aibahtc.jpg" alt="Club Logo" class="h-14 w-14 rounded-full object-cover">
                </div>
                <div class="flex flex-col items-center min-w-[320px]">
                    <span class="block text-2xl font-extrabold text-gray-900 tracking-wide drop-shadow-lg leading-tight whitespace-nowrap">Justice Half Marathon <span class="text-[#005840]">2025</span></span>
                    <span class="block text-base text-[#005840] font-medium tracking-wide whitespace-nowrap">Army IBA Hiking & Trekking Club, Sylhet</span>
                </div>
                <div class="flex flex-row items-center gap-2 text-gray-900 font-semibold text-base">
                    <a href="index.html#home" class="hover:bg-[#005840] hover:text-white px-4 py-2 rounded-xl transition">Home</a>
                    <a href="index.html#about" class="hover:bg-[#005840] hover:text-white px-4 py-2 rounded-xl transition">About</a>
                    <a href="registration.html" class="hover:bg-[#005840] hover:text-white px-4 py-2 rounded-xl transition">Register</a>
                    <a href="confirmation.html" class="bg-[#005840] text-white px-4 py-2 rounded-xl">Confirmation</a>
                    <a href="index.html#route" class="hover:bg-[#005840] hover:text-white px-4 py-2 rounded-xl transition">Route</a>
                    <a href="team.html" class="hover:bg-[#005840] hover:text-white px-4 py-2 rounded-xl transition">Team</a>
                    <a href="index.html#contact" class="hover:bg-[#005840] hover:text-white px-4 py-2 rounded-xl transition">Contact</a>
                </div>
            </div>
            <!-- Mobile & Tablet: show same header for all screens below xl, NOT sticky/fixed -->
            <div class="block xl:hidden">
                <div class="flex flex-col items-center w-full gap-4 py-4">
                    <img src="photos/logo3.png" alt="Event Logo" class="h-28 w-auto sm:h-32 object-contain mb-3 shadow-2xl">
                    <div class="flex flex-row items-center justify-center gap-8 w-full mb-2">
                        <img src="photos/aiba.jpg" alt="AIBA Logo" class="h-16 w-16 sm:h-20 sm:w-20 rounded-full object-cover">
                        <img src="photos/aibahtc.jpg" alt="Club Logo" class="h-16 w-16 sm:h-20 sm:w-20 rounded-full object-cover">
                    </div>
                    <span class="block text-2xl sm:text-3xl font-extrabold text-gray-900 tracking-wide drop-shadow-lg leading-tight whitespace-nowrap">Justice Half Marathon <span class="text-[#005840]">2025</span></span>
                    <span class="block text-xs sm:text-base text-[#005840] font-medium tracking-wide whitespace-nowrap mb-2">Army IBA Hiking & Trekking Club, Sylhet</span>
                    <div class="flex flex-wrap justify-center items-center gap-2 text-gray-900 font-semibold text-sm sm:text-base mt-2">
                        <a href="index.html#home" class="hover:bg-[#005840] hover:text-white px-4 py-2 rounded-xl transition">Home</a>
                        <a href="index.html#about" class="hover:bg-[#005840] hover:text-white px-4 py-2 rounded-xl transition">About</a>
                        <a href="registration.html" class="hover:bg-[#005840] hover:text-white px-4 py-2 rounded-xl transition">Register</a>
                        <a href="confirmation.html" class="bg-[#005840] text-white px-4 py-2 rounded-xl">Confirmation</a>
                        <a href="index.html#route" class="hover:bg-[#005840] hover:text-white px-4 py-2 rounded-xl transition">Route</a>
                        <a href="team.html" class="hover:bg-[#005840] hover:text-white px-4 py-2 rounded-xl transition">Team</a>
                        <a href="index.html#contact" class="hover:bg-[#005840] hover:text-white px-4 py-2 rounded-xl transition">Contact</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-12">
        <div class="max-w-4xl mx-auto">
            <!-- Page Header -->
            <div class="text-center mb-12 fade-in">
                <div class="inline-block bg-white/20 backdrop-filter backdrop-blur-lg rounded-full px-6 py-2 mb-6">
                    <span class="text-main font-semibold">🏃‍♂️ Registration Verification System</span>
                </div>
                <h2 class="text-4xl font-bold section-title mb-6">Registration Confirmation</h2>
                <p class="text-gray-600 text-lg max-w-2xl mx-auto leading-relaxed">
                    নিবন্ধন যাচাই করুন | Verify your registration.
                </p>
            </div>

            <!-- Search Form -->
            <div class="modern-card p-8 mb-12 scale-in">
                <div class="text-center mb-6">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-2">Search Your Registration</h3>
                    <p class="text-gray-600">Enter your mobile number or transaction ID to find your registration</p>
                </div>
                
                <form id="searchForm" class="space-y-6">
                    <div>
                        <label for="searchInput" class="block text-sm font-medium text-gray-700 mb-3">
                            <i class="fas fa-search mr-2 text-main"></i>
                            Mobile Number or Transaction ID | মোবাইল নম্বর বা লেনদেন আইডি
                        </label>
                        <input 
                            type="text" 
                            id="searchInput" 
                            placeholder="01XXXXXXXXX or Transaction ID | মোবাইল নম্বর বা লেনদেন আইডি লিখুন"
                            class="modern-input w-full px-6 py-4 text-lg focus:outline-none focus:ring-0"
                            required
                        >
                    </div>
                    <button 
                        type="submit" 
                        id="searchBtn"
                        class="modern-btn w-full text-white py-4 px-8 text-lg font-semibold flex items-center justify-center space-x-3"
                    >
                        <i class="fas fa-search"></i>
                        <span id="searchBtnText">Search Registration | নিবন্ধন খুঁজুন</span>
                        <div id="loadingSpinner" class="loading-spinner hidden"></div>
                    </button>
                </form>
                
                <!-- Quick Tips -->
                <div class="mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                    <h4 class="font-semibold text-blue-800 mb-2">
                        <i class="fas fa-lightbulb mr-2"></i>
                        Search Tips | অনুসন্ধান টিপস
                    </h4>
                    <ul class="text-blue-700 text-sm space-y-1">
                        <li>• Mobile number format: 01XXXXXXXXX (11 digits)</li>
                        <li>• Transaction ID: Exact ID from your payment receipt</li>
                        <li>• মোবাইল নম্বর ফরম্যাট: ০১XXXXXXXXX (১১ ডিজিট)</li>
                    </ul>
                </div>
            </div>

            <!-- Results Container -->
            <div id="resultsContainer" class="hidden"></div>

            <!-- Support Section -->
            <div class="modern-card p-8 fade-in">
                <div class="text-center mb-6">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-2">
                        <i class="fas fa-headset mr-2 text-main"></i>
                        Need Help? | সাহায্য প্রয়োজন?
                    </h3>
                    <p class="text-gray-600">
                        Our support team is here to help you with any registration issues
                    </p>
                </div>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="text-center p-6 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border border-blue-200">
                        <i class="fas fa-edit text-3xl text-blue-600 mb-4"></i>
                        <h4 class="font-semibold text-blue-800 mb-2">Request Data Correction | তথ্য সংশোধন</h4>
                        <p class="text-blue-700 text-sm mb-4">
                            Want to change your name or T-shirt size? Submit a correction request to update your registration details.
                            <br>আপনার নাম বা টি-শার্টের সাইজ পরিবর্তন করতে চান? আপনার নিবন্ধনের তথ্য আপডেট করার জন্য সংশোধনের অনুরোধ জমা দিন।
                        </p>
                        <a 
                            href="https://docs.google.com/forms/d/e/1FAIpQLSdbV1CVKnpNBauOilA4CeTvjaOSrBWJL-lFrRW4JryXMAv6GA/viewform?usp=dialog"
                            target="_blank"
                            class="inline-block bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition duration-300 font-semibold"
                        >
                            <i class="fas fa-external-link-alt mr-2"></i>
                            Data Correction
                        </a>
                    </div>
                    
                    <div class="text-center p-6 bg-gradient-to-br from-red-50 to-pink-50 rounded-lg border border-red-200">
                        <i class="fas fa-search-plus text-3xl text-red-600 mb-4"></i>
                        <h4 class="font-semibold text-red-800 mb-2">Report Missing Registration | হারিয়ে যাওয়া নিবন্ধন</h4>
                        <p class="text-red-700 text-sm mb-4">
                            Can't find your registration in our system? Submit your payment details for verification.
                            <br>আমাদের সিস্টেমে আপনার নিবন্ধন নেই? যাচাইয়ের জন্য পেমেন্টের বিস্তারিত জমা দিন।
                        </p>
                        <a 
                            href="https://docs.google.com/forms/d/1ePfnrbZaOFLf7iZuqHS9QUggghhdsdsxxLY3wT6BiolIwk9URMyI/edit"
                            target="_blank"
                            class="inline-block bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 transition duration-300 font-semibold"
                        >
                            <i class="fas fa-external-link-alt mr-2"></i>
                            Missing Registration
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Professional Single Footer -->
    <footer class="bg-gradient-to-br from-main via-[#004a35] to-[#003d2b] text-white mt-16">
        <div class="container mx-auto px-4 py-8">
            <!-- Main Footer Content -->
            <div class="text-center">
                <div class="flex items-center justify-center mb-4">
                    <img src="photos/mini logo 2.jpg" alt="Marathon Logo" class="h-12 w-auto mr-3" loading="lazy">
                    <div>
                        <h3 class="text-xl font-bold text-white">Justice Half Marathon 2025</h3>
                        <p class="text-gray-300 text-sm">Army IBA Hiking & Trekking Club, Sylhet</p>
                    </div>
                </div>
                <p class="text-gray-300 text-sm leading-relaxed max-w-2xl mx-auto">
                    Join Bangladesh's premier running event on September 26th, 2025. Experience the thrill of running through the scenic routes of Sylhet while being part of a community that values fitness, determination, and unity.
                </p>
            </div>

            <!-- Bottom Footer -->
            <div class="border-t border-gray-400 pt-4 mt-6">
                <div class="text-center space-y-2">
                    <p class="text-white text-sm">
                        © 2025 Army Institute of Business Administration - Hiking & Trekking Club, Sylhet. All rights reserved.
                    </p>
                    <p class="text-white text-sm">
                        Design and developed by 
                        <a href="https://me.gmrafi.com/" target="_blank" rel="noopener" class="text-white hover:text-yellow-300 transition font-semibold underline">
                            MD Golam Mubasshir Rafi
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Configuration
        const CONFIG = {
            // Google Apps Script deployment URL - UPDATED WITH YOUR ACTUAL URL
            API_URL: 'https://script.google.com/macros/s/AKfycbxa6-hycDC9W4Ze6aH-Ja3Wo1amI_nIeqiXhfawWgrBH7Sf25gZ15ses-wtFBYfc1vD/exec',
            
            // Form URLs for support
            ISSUE_FORM_URL: 'https://docs.google.com/forms/d/e/1FAIpQLSeHw2YZlT-A9y_-dKZwFBgqLYOJX8TcSPbD4GGEObvEgY0Vrw/viewform',
            DATA_CORRECTION_URL: 'https://docs.google.com/forms/d/e/1FAIpQLSdbV1CVKnpNBauOilA4CeTvjaOSrBWJL-lFrRW4JryXMAv6GA/viewform?usp=dialog',
            MISSING_REGISTRATION_URL: 'https://docs.google.com/forms/d/1ePfnrbZaOFLf7iZuqHS9QUggghhdsdsxxLY3wT6BiolIwk9URMyI/edit',
            CORRECTION_FORM_URL: 'https://docs.google.com/forms/d/e/1FAIpQLSdA9K1wnkW8Z9v6gDqeR8t5i6Q0EFQIoELwNvG6p6jCGjPePQ/viewform'
        };

        // DOM Elements
        const searchForm = document.getElementById('searchForm');
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.getElementById('searchBtn');
        const searchBtnText = document.getElementById('searchBtnText');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const resultsContainer = document.getElementById('resultsContainer');

        // Form submission handler
        searchForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const searchValue = searchInput.value.trim();
            if (!searchValue) {
                alert('অনুগ্রহ করে মোবাইল নম্বর বা লেনদেন আইডি দিন | Please enter mobile number or transaction ID');
                return;
            }
            
            await searchRegistration(searchValue);
        });

        // Search function
        async function searchRegistration(searchValue) {
            // Show loading state
            setLoadingState(true);
            
            try {
                // Check if script URL is configured
                if (CONFIG.API_URL.includes('YOUR_NEW_DEPLOYMENT_URL')) {
                    displayConfigurationMessage();
                    return;
                }
                
                // Determine search type - improved logic
                let searchType;
                if (/^01\d{9}$/.test(searchValue)) {
                    // Bangladesh mobile number format: 01xxxxxxxxx (11 digits)
                    searchType = 'mobile';
                } else {
                    // Anything else is considered transaction ID
                    searchType = 'transaction';
                }
                
                console.log('Search type determined:', searchType, 'for value:', searchValue);
                
                // Try multiple fetch methods
                let response;
                let data;
                
                // Method 1: Form data (most reliable for Google Apps Script)
                try {
                    const formData = new FormData();
                    formData.append('action', 'searchRegistration');
                    formData.append('searchType', searchType);
                    formData.append('searchValue', searchValue);
                    
                    response = await fetch(CONFIG.API_URL, {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (response.ok) {
                        data = await response.json();
                        console.log('Method 1 (FormData) success:', data);
                    } else {
                        throw new Error('Method 1 failed');
                    }
                } catch (error1) {
                    console.log('Method 1 failed, trying Method 2:', error1.message);
                    
                    // Method 2: URL encoded data
                    try {
                        const params = new URLSearchParams({
                            action: 'searchRegistration',
                            searchType: searchType,
                            searchValue: searchValue
                        });
                        
                        response = await fetch(CONFIG.API_URL, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/x-www-form-urlencoded',
                            },
                            body: params
                        });
                        
                        if (response.ok) {
                            data = await response.json();
                            console.log('Method 2 (URLEncoded) success:', data);
                        } else {
                            throw new Error('Method 2 failed');
                        }
                    } catch (error2) {
                        console.log('Method 2 failed, trying Method 3:', error2.message);
                        
                        // Method 3: GET request with parameters
                        try {
                            const getParams = new URLSearchParams({
                                action: 'searchRegistration',
                                searchType: searchType,
                                searchValue: searchValue
                            });
                            
                            response = await fetch(`${CONFIG.API_URL}?${getParams}`, {
                                method: 'GET'
                            });
                            
                            if (response.ok) {
                                data = await response.json();
                                console.log('Method 3 (GET) success:', data);
                            } else {
                                throw new Error('All methods failed');
                            }
                        } catch (error3) {
                            console.log('All methods failed:', error3.message);
                            throw new Error('Failed to connect to server');
                        }
                    }
                }
                
                console.log('Final response status:', response.status);
                console.log('Final response ok:', response.ok);
                console.log('Final response data:', data);
                
                if (data.success && data.data) {
                    displayRegistrationDetails(data.data);
                } else {
                    displayNotFoundMessage(data.message || 'Registration not found');
                }
                
            } catch (error) {
                console.error('Search error:', error);
                console.log('Error type:', typeof error);
                console.log('Error name:', error.name);
                console.log('Error message:', error.message);
                
                displayErrorMessage(getErrorMessage(error));
                
            } finally {
                setLoadingState(false);
            }
        }

        // Helper function to check if string is numeric
        function isNumeric(str) {
            return /^\d+$/.test(str);
        }

        // Get appropriate error message
        function getErrorMessage(error) {
            console.log('Full error:', error);
            if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {
                return 'নেটওয়ার্ক সমস্যা। আবার চেষ্টা করুন। | Network issue. Please try again.';
            } else if (error.message.includes('HTTP error')) {
                return 'সার্ভার সমস্যা। আবার চেষ্টা করুন। | Server issue. Please try again.';
            } else if (error.message.includes('CORS')) {
                return 'CORS সমস্যা। Google Apps Script সেটিং চেক করুন। | CORS issue. Check Google Apps Script settings.';
            } else {
                return 'সিস্টেমে সমস্যা হয়েছে। আবার চেষ্টা করুন। | System error. Please try again.';
            }
        }

        // Display configuration message
        function displayConfigurationMessage() {
            const html = `
                <div class="bg-white rounded-lg shadow-lg p-6 fade-in">
                    <div class="text-center">
                        <div class="bg-blue-100 text-blue-800 px-4 py-2 rounded-full inline-block mb-4">
                            <i class="fas fa-cog mr-2"></i>
                            Configuration Required | কনফিগারেশন প্রয়োজন
                        </div>
                        
                        <h3 class="text-xl font-bold text-gray-800 mb-4">System Configuration Required</h3>
                        
                        <div class="text-left bg-gray-50 p-4 rounded-lg mb-4">
                            <h4 class="font-semibold mb-2">To enable the confirmation system:</h4>
                            <ol class="list-decimal list-inside space-y-1 text-sm">
                                <li>Deploy the Google Apps Script using <code>google-apps-script-confirmation-updated.js</code></li>
                                <li>Copy the deployment URL</li>
                                <li>Replace <code>YOUR_SCRIPT_ID</code> in CONFIG with the actual URL</li>
                                <li>Update the Google Sheets ID in the Apps Script file</li>
                                <li>Test the connection</li>
                            </ol>
                        </div>
                        
                        <p class="text-gray-600 mb-6">
                            সিস্টেম কনফিগার করা হয়নি। Google Apps Script deploy করে URL আপডেট করুন।
                            <br>
                            System not configured. Deploy Google Apps Script and update URL.
                        </p>
                        
                        <div class="space-y-3">
                            <button 
                                onclick="clearResults()" 
                                class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition duration-300"
                            >
                                OK | ঠিক আছে
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            resultsContainer.innerHTML = html;
            resultsContainer.classList.remove('hidden');
            resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Display registration details
        function displayRegistrationDetails(registration) {
            const html = `
                <div class="modern-card p-8 slide-up">
                    <!-- Success Header -->
                    <div class="text-center mb-8">
                        <div class="inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4">
                            <i class="fas fa-check-circle text-3xl text-green-600"></i>
                        </div>
                        <h3 class="text-3xl font-bold section-title mb-2">Registration Found!</h3>
                        <p class="text-gray-600">নিবন্ধন পাওয়া গেছে | Your registration details are displayed below</p>
                    </div>
                    
                    <!-- Registration Details Grid -->
                    <div class="grid lg:grid-cols-2 gap-8 mb-8">
                        <!-- Personal Information -->
                        <div class="space-y-4">
                            <h4 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-user mr-3 text-main"></i>
                                Personal Information
                            </h4>
                            
                            <div class="data-item">
                                <label class="block text-sm font-medium text-gray-600 mb-2">
                                    <i class="fas fa-id-card mr-2"></i>Full Name | নাম
                                </label>
                                <p class="text-lg font-semibold text-gray-800">${registration.name || 'N/A'}</p>
                            </div>
                            
                            <div class="data-item">
                                <label class="block text-sm font-medium text-gray-600 mb-2">
                                    <i class="fas fa-hashtag mr-2"></i>Serial Number | সিরিয়াল নম্বর
                                </label>
                                <p class="text-lg font-semibold ${registration.serialNumber && registration.serialNumber !== 'Pending' ? 'text-green-600' : 'text-yellow-600'}">${registration.serialNumber || 'Pending Assignment'}</p>
                            </div>
                            
                            <div class="data-item">
                                <label class="block text-sm font-medium text-gray-600 mb-2">
                                    <i class="fas fa-mobile-alt mr-2"></i>Mobile | মোবাইল
                                </label>
                                <p class="text-lg font-semibold text-gray-800">${registration.mobile || 'N/A'}</p>
                            </div>
                            
                            <div class="data-item">
                                <label class="block text-sm font-medium text-gray-600 mb-2">
                                    <i class="fas fa-envelope mr-2"></i>Email | ইমেইল
                                </label>
                                <p class="text-lg font-semibold text-gray-800 break-all">${registration.email || 'N/A'}</p>
                            </div>
                        </div>
                        
                        <!-- Registration Details -->
                        <div class="space-y-4">
                            <h4 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-clipboard-list mr-3 text-main"></i>
                                Registration Details
                            </h4>
                            
                            <div class="data-item">
                                <label class="block text-sm font-medium text-gray-600 mb-2">
                                    <i class="fas fa-tshirt mr-2"></i>T-Shirt Size | টি-শার্ট সাইজ
                                </label>
                                <p class="text-lg font-semibold text-gray-800">${registration.tshirtSize || 'N/A'}</p>
                            </div>
                            
                            <div class="data-item">
                                <label class="block text-sm font-medium text-gray-600 mb-2">
                                    <i class="fas fa-running mr-2"></i>Category | ক্যাটাগরি
                                </label>
                                <p class="text-lg font-semibold text-gray-800">${registration.category || 'N/A'}</p>
                            </div>
                            
                            <div class="data-item">
                                <label class="block text-sm font-medium text-gray-600 mb-2">
                                    <i class="fas fa-credit-card mr-2"></i>Payment Status | পেমেন্ট স্ট্যাটাস
                                </label>
                                <div class="${(registration.paymentStatus === 'Confirmed' || registration.paymentStatus === 'Confirm') ? 'status-confirmed' : 'status-pending'}">
                                    <i class="fas ${(registration.paymentStatus === 'Confirmed' || registration.paymentStatus === 'Confirm') ? 'fa-check-circle' : 'fa-clock'}"></i>
                                    <span>${registration.paymentStatus || 'Pending'}</span>
                                </div>
                            </div>
                            
                            <div class="data-item">
                                <label class="block text-sm font-medium text-gray-600 mb-2">
                                    <i class="fas fa-edit mr-2"></i>Correction Status | সংশোধনের অবস্থা
                                </label>
                                <p class="text-lg font-semibold ${registration.correctionStatus && registration.correctionStatus !== 'No Change Request' ? 'text-blue-600' : 'text-gray-600'}">${registration.correctionStatus || 'No Change Request'}</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Status Alerts -->
                    ${(registration.paymentStatus === 'Confirmed' || registration.paymentStatus === 'Confirm') ? `
                        <div class="alert-success p-6 mb-6">
                            <div class="flex items-start space-x-4">
                                <i class="fas fa-check-circle text-2xl text-green-600 mt-1"></i>
                                <div>
                                    <h4 class="font-semibold text-green-800 mb-2">Registration Confirmed! | নিবন্ধন নিশ্চিত!</h4>
                                    <p class="text-green-700">
                                        🎉 Congratulations! Your registration is confirmed. You will receive your BIB and race kit during the packet pickup.
                                        <br><br>
                                        অভিনন্দন! আপনার নিবন্ধন নিশ্চিত হয়েছে। প্যাকেট পিকআপের সময় আপনি আপনার BIB এবং রেস কিট পাবেন।
                                    </p>
                                </div>
                            </div>
                        </div>
                    ` : `
                        <div class="alert-warning p-6 mb-6">
                            <div class="flex items-start space-x-4">
                                <i class="fas fa-exclamation-triangle text-2xl text-yellow-600 mt-1"></i>
                                <div>
                                    <h4 class="font-semibold text-yellow-800 mb-2">Payment Verification Pending | পেমেন্ট যাচাইকরণ বাকি</h4>
                                    <p class="text-yellow-700">
                                        ⏳ Your registration is received but payment verification is pending. Please complete payment if not done yet.
                                        <br><br>
                                        আপনার নিবন্ধন পাওয়া গেছে কিন্তু পেমেন্ট যাচাইকরণ বাকি। যদি পেমেন্ট না করে থাকেন তাহলে দ্রুত সম্পন্ন করুন।
                                    </p>
                                </div>
                            </div>
                        </div>
                    `}
                    
                    <!-- Correction Status -->
                    ${registration.correctionStatus && registration.correctionStatus !== 'No Change Request' ? `
                        <div class="alert-warning p-6 mb-6">
                            <div class="flex items-start space-x-4">
                                <i class="fas fa-edit text-2xl text-blue-600 mt-1"></i>
                                <div>
                                    <h4 class="font-semibold text-blue-800 mb-2">Correction Request Status | সংশোধনের অবস্থা</h4>
                                    <p class="text-blue-700 font-medium">${registration.correctionStatus}</p>
                                    ${registration.comment && registration.comment !== 'No comments' ? `
                                        <p class="text-blue-600 text-sm mt-2 bg-blue-50 p-3 rounded-lg">
                                            <strong>Comment:</strong> ${registration.comment}
                                        </p>
                                    ` : ''}
                                </div>
                            </div>
                        </div>
                    ` : ''}
                    
                    <!-- Action Buttons -->
                    <div class="flex flex-col sm:flex-row gap-4 justify-center pt-6 border-t border-gray-200">
                        <button 
                            onclick="clearResults()" 
                            class="bg-gray-600 text-white px-8 py-3 rounded-lg hover:bg-gray-700 transition duration-300 font-semibold"
                        >
                            <i class="fas fa-search mr-2"></i>
                            Search Again | আবার খুঁজুন
                        </button>
                        
                        <button 
                            onclick="window.print()" 
                            class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition duration-300 font-semibold"
                        >
                            <i class="fas fa-print mr-2"></i>
                            Print Details | প্রিন্ট করুন
                        </button>
                    </div>
                </div>
            `;
            
            resultsContainer.innerHTML = html;
            resultsContainer.classList.remove('hidden');
            resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Display not found message
        function displayNotFoundMessage(backendMessage = null) {
            const html = `
                <div class="modern-card p-8 slide-up">
                    <div class="text-center">
                        <div class="inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-6">
                            <i class="fas fa-search-minus text-3xl text-red-600"></i>
                        </div>
                        
                        <h3 class="text-3xl font-bold section-title mb-4">Registration Not Found</h3>
                        <p class="text-xl text-red-600 font-semibold mb-2">নিবন্ধন পাওয়া যায়নি</p>
                        
                        <div class="max-w-md mx-auto">
                            <p class="text-gray-600 mb-8 leading-relaxed">
                                ${backendMessage && backendMessage.includes('নিবন্ধন পাওয়া যায়নি') ? 
                                    backendMessage :
                                    'আপনার দেয়া তথ্যের সাথে কোনো নিবন্ধন পাওয়া যায়নি। অনুগ্রহ করে সঠিক মোবাইল নম্বর বা লেনদেন আইডি দিয়ে আবার চেষ্টা করুন।'
                                }
                                <br><br>
                                We couldn't find any registration with the provided information. Please double-check your mobile number or transaction ID and try again.
                            </p>
                        </div>
                        
                        <!-- Troubleshooting Tips -->
                        <div class="bg-blue-50 p-6 rounded-lg mb-8 text-left max-w-lg mx-auto">
                            <h4 class="font-semibold text-blue-800 mb-3 flex items-center">
                                <i class="fas fa-lightbulb mr-2"></i>
                                Troubleshooting Tips | সমস্যা সমাধানের টিপস
                            </h4>
                            <ul class="text-blue-700 space-y-2 text-sm">
                                <li class="flex items-start">
                                    <i class="fas fa-check text-blue-500 mr-2 mt-1"></i>
                                    Verify your mobile number format: 01XXXXXXXXX
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check text-blue-500 mr-2 mt-1"></i>
                                    Check your transaction ID from payment receipt
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check text-blue-500 mr-2 mt-1"></i>
                                    Try alternative phone number if provided
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check text-blue-500 mr-2 mt-1"></i>
                                    মোবাইল নম্বর ফরম্যাট যাচাই করুন: ০১XXXXXXXXX
                                </li>
                            </ul>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="grid sm:grid-cols-3 gap-4 max-w-2xl mx-auto">
                            <button 
                                onclick="clearResults()" 
                                class="modern-btn bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition duration-300 font-semibold"
                            >
                                <i class="fas fa-search mr-2"></i>
                                Try Again
                            </button>
                            
                            <a 
                                href="${CONFIG.ISSUE_FORM_URL}"
                                target="_blank"
                                class="modern-btn bg-yellow-600 hover:bg-yellow-700 text-white px-6 py-3 rounded-lg transition duration-300 font-semibold text-center block"
                            >
                                <i class="fas fa-bug mr-2"></i>
                                Report Issue
                            </a>
                            
                            <a 
                                href="register.html"
                                class="modern-btn bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg transition duration-300 font-semibold text-center block"
                            >
                                <i class="fas fa-user-plus mr-2"></i>
                                Register Now
                            </a>
                        </div>
                        
                        <p class="text-gray-500 text-sm mt-6">
                            আবার চেষ্টা করুন | এখনই নিবন্ধন করুন | সমস্যা রিপোর্ট করুন
                        </p>
                    </div>
                </div>
            `;
            
            resultsContainer.innerHTML = html;
            resultsContainer.classList.remove('hidden');
            resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Display error message
        function displayErrorMessage(message) {
            const html = `
                <div class="modern-card p-8 slide-up">
                    <div class="text-center">
                        <div class="inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-6">
                            <i class="fas fa-exclamation-triangle text-3xl text-red-600"></i>
                        </div>
                        
                        <h3 class="text-3xl font-bold section-title mb-4">System Error</h3>
                        <p class="text-xl text-red-600 font-semibold mb-6">সিস্টেম ত্রুটি</p>
                        
                        <div class="alert-error p-6 mb-8 max-w-md mx-auto">
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-info-circle text-red-600 text-xl"></i>
                                <p class="text-red-700 font-medium">${message}</p>
                            </div>
                        </div>
                        
                        <!-- Common Solutions -->
                        <div class="bg-gray-50 p-6 rounded-lg mb-8 text-left max-w-lg mx-auto">
                            <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                                <i class="fas fa-tools mr-2"></i>
                                Common Solutions | সাধারণ সমাধান
                            </h4>
                            <ul class="text-gray-700 space-y-2 text-sm">
                                <li class="flex items-start">
                                    <i class="fas fa-wifi text-gray-500 mr-2 mt-1"></i>
                                    Check your internet connection | ইন্টারনেট সংযোগ চেক করুন
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-refresh text-gray-500 mr-2 mt-1"></i>
                                    Try refreshing the page | পেজ রিফ্রেশ করে দেখুন
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-clock text-gray-500 mr-2 mt-1"></i>
                                    Wait a moment and try again | কিছুক্ষণ অপেক্ষা করে আবার চেষ্টা করুন
                                </li>
                            </ul>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="grid sm:grid-cols-2 gap-4 max-w-md mx-auto">
                            <button 
                                onclick="clearResults()" 
                                class="modern-btn bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition duration-300 font-semibold"
                            >
                                <i class="fas fa-redo mr-2"></i>
                                Try Again
                            </button>
                            
                            <a 
                                href="${CONFIG.ISSUE_FORM_URL}"
                                target="_blank"
                                class="modern-btn bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg transition duration-300 font-semibold text-center block"
                            >
                                <i class="fas fa-bug mr-2"></i>
                                Report Error
                            </a>
                        </div>
                        
                        <p class="text-gray-500 text-sm mt-6">
                            আবার চেষ্টা করুন | টেকনিক্যাল সমস্যা রিপোর্ট করুন
                        </p>
                    </div>
                </div>
            `;
            
            resultsContainer.innerHTML = html;
            resultsContainer.classList.remove('hidden');
            resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Set loading state
        function setLoadingState(isLoading) {
            if (isLoading) {
                searchBtn.disabled = true;
                searchBtnText.textContent = 'Searching... | খোঁজ করা হচ্ছে...';
                loadingSpinner.classList.remove('hidden');
            } else {
                searchBtn.disabled = false;
                searchBtnText.textContent = 'Search Registration | নিবন্ধন খুঁজুন';
                loadingSpinner.classList.add('hidden');
            }
        }

        // Clear results
        function clearResults() {
            resultsContainer.classList.add('hidden');
            resultsContainer.innerHTML = '';
            searchInput.value = '';
            searchInput.focus();
        }

        // Auto-focus search input on page load
        window.addEventListener('load', function() {
            searchInput.focus();
        });
    </script>

    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
</body>
</html>
